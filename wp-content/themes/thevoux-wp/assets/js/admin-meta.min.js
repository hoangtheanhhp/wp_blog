jQuery(document).ready(function(r){r(".thb-register:not(.disabled)").on("click",function(e){var a=r(this),t=r("#thb_product_key").val(),i=r("#thb_purchase_code").val(),o=a.hasClass("thb_purchase_code"),n=o?a.data("verify-by-purchase"):a.data("verify"),d={domain:a.data("domain")};return o?d.purchase_code=i:d.product_key=t,r.ajax({method:"GET",url:n,data:d,beforeSend:function(){a.addClass("disabled")},error:function(e){if(a.removeClass("disabled"),e.responseText){var t=r.parseJSON(e.responseText);t.error_message&&r("#thb_error_messages").html("<p>"+t.error_message+"</p>")}},success:function(e){e.product_key&&(t=e.product_key),r.ajax(ajaxurl,{method:"POST",data:{action:"thb_update_options",key:t,expired:0},success:function(){location.reload()}})}}),!1}),r(".thb-delete-key").on("click",function(e){r(this);return r.ajax(ajaxurl,{method:"POST",data:{action:"thb_update_options",key:"",expired:0},success:function(){location.reload()}}),!1});var o=new FormData;"undefined"!=typeof ocdi&&(o.append("action","ocdi_import_demo_data"),o.append("security",ocdi.ajax_nonce)),r(".thb-load-demo:not(.disabled)").on("click",function(e){var t=r(this),a=t.parents(".theme"),i=t.data("demo");a.addClass("loading"),r(".thb-load-demo").addClass("disabled").attr("disabled","disabled").unbind("click"),o.append("selected",i),function a(i){r.ajax({method:"POST",url:ocdi.ajax_url,data:i,contentType:!1,processData:!1}).done(function(e){if(void 0!==e.status&&"newAJAX"===e.status)a(i);else if(void 0!==e.status&&"afterAllImportAJAX"===e.status){var t=new FormData;t.append("action","ocdi_after_import_data"),t.append("security",ocdi.ajax_nonce),a(t)}else location.reload()})}(o),e.preventDefault()}),ThbImage={uploader:function(e,t,a){var i=wp.media({title:ThbImageWidget.frame_title,multiple:!1,library:{type:"image"},button:{text:ThbImageWidget.button_title}});return i.on("close",function(){var e=i.state().get("selection").toJSON();r("#"+t).val(e[0].url),r("#"+a).val(e[0].alt)}),i.open(),!1}};var e=function(e){var i=e.find(".thb-image-holder"),o=e.find(".thb-upload-image"),n=e.find(".thb-remove-image"),d=e.find(".thb-image-id");0<d.val().length?(o.hide(),n.show()):(o.show(),n.hide()),o.on("click",function(e){var t,a;e.preventDefault(),t=function(e){var t="";t=void 0!==e.sizes.thumbnail?e.sizes.thumbnail:e.sizes.full,i.html('<img src="'+t.url+'" width="'+t.width+'" height="'+t.height+'" />'),d.val(e.id),o.hide(),n.show()},(a=wp.media({title:"Select an image",multiple:!1,library:{type:"image"},button:{text:"Add Image"}})).on("select",function(){var e=a.state().get("selection").first().toJSON();t(e)}),a.open()}),n.on("click",function(e){e.preventDefault(),confirm("Are you sure?")&&(i.empty(),d.val(""),o.show(),n.hide())})};r(".thb-upload-image-field").each(function(){e(r(this))})});